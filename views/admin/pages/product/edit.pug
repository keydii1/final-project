extends ../../layouts/default.pug
include ../../mixins/alert.pug
include ../../mixins/select-tree.pug
block main
  if role.permissions.includes("products_edit")
    +alert-success("2000")
    +alert-error("2000")
    .container.mt-4
      h2.mb-4 Chỉnh sửa sản phẩm
      form(
        action=`${prefixAdmin}/products/edit/${product.id}?_method=PATCH` 
        method="POST" 
        enctype="multipart/form-data"
      )
        // Tiêu đề
        .form-group
          label(for="title") Tiêu đề
          input#title.form-control(
            type="text" 
            name="title" 
            placeholder="Nhập tiêu đề sản phẩm"
            value = product.title
          )
        .form-group
              label(for="product_category_id") Danh mục
              select#parent_id.form-control(name="product_category_id")
                option(value="") -- Chọn danh mục cha --
                if category
                  +select-tree(category, product.product_category_id)

        // Mô tả
        .form-group
          label(for="description") Mô tả
          textarea#description.form-control(
            name="description" 
            rows="3" 
            placeholder="Nhập mô tả sản phẩm"
            class="description"
          ) #{product.description}

        // Giá
        .form-group
          label(for="price") Giá
          input#price.form-control(
            type="number" 
            step="0.01"
            name="price" 
            placeholder="Nhập giá sản phẩm"
            value = product.price
          )

        // Giảm giá %
        .form-group
          label(for="discountPercentage") Giảm giá (%)
          input#discountPercentage.form-control(
            type="number" 
            step="0.01"
            name="discountPercentage" 
            placeholder="Nhập % giảm giá"
            value = product.discountPercentage
          )

        // Tồn kho
        .form-group
          label(for="stock") Số lượng tồn kho
          input#stock.form-control(
            type="number" 
            name="stock" 
            placeholder="Nhập số lượng sản phẩm trong kho"
            value = product.stock
          )

        // Hình ảnh
        .form-group(upload-image)
          label(for="thumbnail") Hình ảnh
          input#thumbnail.form-control(
            type="file" 
            name="thumbnail" 
            accept="image/*"
            upload-image-input
            value = product.thumbnail
          )
          img(
            class ="image-preview"
            src=`${product.thumbnail}` 
            upload-image-preview
          )

        // Vị trí
        .form-group
          label(for="position") Vị trí
          input#position.form-control(
            type="number" 
            name="position" 
            placeholder="Nhập vị trí sắp xếp"
            value = product.position
          )

        // Trạng thái
        .form-group
          label(for="status") Trạng thái
          select#status.form-control(name="status" required)
            option(value="active") Kích hoạt
            option(value="inactive") Vô hiệu hóa

        // Nút submit
        button.btn.btn-primary(type="submit") Cập nhật sản phẩm 
  else 
    h1 Bạn chưa được cấp quyền chỉnh sửa sản phẩm, vui lòng liên hệ quản trị viên
