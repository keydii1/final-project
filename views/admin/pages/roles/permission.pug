extends ../../layouts/default.pug
include ../../mixins/alert.pug

block main
    if !role.permissions.includes("permission_view")
        h1 Bạn chưa được cấp quyền phân quyền, vui lòng liên hệ quản trị viên
        return
    //- Hiển thị thông báo (nếu có)
    +alert-success(2000)

    h1(class="mt-4") Phân quyền

    //- Dữ liệu record được truyền sang cho file JS
    div(data-record=record class="d-none")

    //- Nút Cập nhật
    div(class="text-right")
        button(
            type="submit" 
            class="btn btn-primary mb-3" 
            button-submit
        ) Cập nhật
    //- Bảng phân quyền
    table(class="table table-hover table-bordered" table-permission)
        thead
            tr
                th(style="width: 200px;") Tính năng
                //- Sửa ở đây: Thêm data-id=item.id để file JS có thể lấy được ID vai trò
                each item in record
                    th(class="text-center" data-id=item.id)= item.title
        tbody
            //- Bắt đầu nhóm quyền: Danh mục sản phẩm
            tr
                td(colspan=record.length + 1)
                    b Danh mục sản phẩm
            tr(data-name="products-category_view")
                td Xem
                each item in record
                    td(class="text-center")
                        input(type="checkbox")
            tr(data-name="products-category_create")
                td Thêm mới
                each item in record
                    td(class="text-center")
                        input(type="checkbox")
            tr(data-name="products-category_edit")
                td Chỉnh sửa
                each item in record
                    td(class="text-center")
                        input(type="checkbox")
            tr(data-name="products-category_delete")
                td Xóa
                each item in record
                    td(class="text-center")
                        input(type="checkbox")
            
            //- Bắt đầu nhóm quyền: Sản phẩm
            tr
                td(colspan=record.length + 1)
                    b Sản phẩm
            tr(data-name="products_view")
                td Xem
                each item in record
                    td(class="text-center")
                        input(type="checkbox")
            tr(data-name="products_create")
                td Thêm mới
                each item in record
                    td(class="text-center")
                        input(type="checkbox")
            tr(data-name="products_edit")
                td Chỉnh sửa
                each item in record
                    td(class="text-center")
                        input(type="checkbox")
            tr(data-name="products_delete")
                td Xóa
                each item in record
                    td(class="text-center")
                        input(type="checkbox")
            //- Bắt đầu nhóm quyền: Nhóm quyền
            tr
                td(colspan=record.length + 1)
                    b Nhóm quyền
            tr(data-name="roles_view")
                td Xem
                each item in record
                    td(class="text-center")
                        input(type="checkbox")
            tr(data-name="roles_create")
                td Thêm mới
                each item in record
                    td(class="text-center")
                        input(type="checkbox")
            tr(data-name="roles_edit")
                td Chỉnh sửa
                each item in record
                    td(class="text-center")
                        input(type="checkbox")
            tr(data-name="roles_delete")
                td Xóa
                each item in record
                    td(class="text-center")
                        input(type="checkbox")
            //- Bắt đầu nhóm quyền: Tài khoản
            tr
                td(colspan=record.length + 1)
                    b Phân quyền tài khoản
            tr(data-name="permission_view")
                td Xem
                each item in record
                    td(class="text-center")
                        input(type="checkbox")
            tr(data-name="permission_create")
                td Thêm mới
                each item in record
                    td(class="text-center")
                        input(type="checkbox")
            tr(data-name="permission_edit")
                td Chỉnh sửa
                each item in record
                    td(class="text-center")
                        input(type="checkbox")
            tr(data-name="permission_delete")
                td Xóa
                each item in record
                    td(class="text-center")
                        input(type="checkbox")
            //- Bắt đầu nhóm quyền: Danh sách tài khoản
            tr
                td(colspan=record.length + 1)
                    b Danh sách tài khoản
            tr(data-name="account_view")
                td Xem
                each item in record
                    td(class="text-center")
                        input(type="checkbox")
            tr(data-name="account_create")
                td Thêm mới
                each item in record
                    td(class="text-center")
                        input(type="checkbox")
            tr(data-name="account_edit")
                td Chỉnh sửa
                each item in record
                    td(class="text-center")
                        input(type="checkbox")
            tr(data-name="account_delete")
                td Xóa
                each item in record
                    td(class="text-center")
                        input(type="checkbox")


    //- Form ẩn để gửi dữ liệu đi, được điều khiển bằng JavaScript
    form(
        action=`${prefixAdmin}/role/permission?_method=PATCH`
        method="POST" 
        id="form-change-permission"
        class="d-none"
    )
        div(class="form-group")
            input(
                type="text"
                name="permissions"
                class="form-control"
            )

    //- Nhúng file JavaScript để xử lý logic
    script(src=`${prefixAdmin}/scripts/role.js`)